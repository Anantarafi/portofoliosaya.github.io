// Complete Translation data for Portfolio Gallery
const translations = {
    id: {
        // Meta and page info
        'page-title': 'Portofolio - Irsyada Rafi Ananta',
        'meta-description': 'Portfolio Irsyada Rafi Ananta - Graphic Design & UI/UX Designer dengan pengalaman dalam pengembangan web dan desain digital',
        
        // Navigation
        'nav-home': 'Beranda',
        'nav-about': 'Tentang',
        'nav-skills': 'Keahlian',
        'nav-projects': 'Proyek',
        'nav-contact': 'Kontak',
        
        // Hero section
        'hero-greeting': 'Halo, Saya',
        'hero-role': 'Graphic Design & UI/UX Designer',
        'hero-description': 'Saya menciptakan pengalaman digital yang menakjubkan dengan desain yang menarik.',
        'btn-view-projects': 'Lihat Proyek',
        'btn-contact-me': 'Hubungi Saya',
        
        // About section
        'about-title': 'Tentang Saya',
        'about-description': 'Fresh graduate D3 Teknik Informatika dengan pengalaman magang sebagai Fullstack Developer. Terampil dalam pengembangan aplikasi web end-to-end menggunakan PHP, CodeIgniter, dan JavaScript. Memiliki semangat tinggi dalam merancang antarmuka (UI/UX) yang intuitif dan fungsional menggunakan Figma untuk memberikan pengalaman pengguna terbaik.',
        
        // Skills section
        'skills-title': 'Keahlian',
        
        // Projects section - Gallery
        'projects-title': 'Proyek Saya',
        
        // Project filters
        'filter-all': 'Semua',
        'filter-ui-ux': 'UI/UX',
        'filter-web': 'Website',
        'filter-design': 'Desain',
        'filter-mobile': 'Mobile',
        'filter-graphic': 'Grafis',
        
        // Project search
        'search-placeholder': 'Cari proyek...',
        'search-no-results': 'Tidak ada proyek yang ditemukan.',
        'search-results-count': 'proyek ditemukan',
        'search-try-different': 'Coba kata kunci yang berbeda atau pilih kategori lain.',
        
        // Project actions
        'btn-view-details': 'Lihat Detail',
        'btn-view-demo': 'Lihat Demo',
        'btn-view-code': 'Lihat Kode',
        'btn-download': 'Unduh',
        'btn-live-preview': 'Preview Langsung',
        
        // Project titles and descriptions
        'project-craft-title': 'UI/UX Kerajinan Tradisional',
        'project-craft-desc': 'Desain antarmuka aplikasi untuk promosi kerajinan tradisional dengan konsep modern yang mempertahankan nilai budaya.',
        'project-food-title': 'UI/UX Pemesanan Makanan',
        'project-food-desc': 'Aplikasi pemesanan makanan dengan antarmuka yang user-friendly dan proses checkout yang mudah.',
        'project-car-title': 'UI/UX Website Modifikasi Mobil',
        'project-car-desc': 'Website untuk layanan modifikasi mobil dengan galeri showcase dan sistem booking online.',
        'project-banner-title': 'Desain Banner',
        'project-banner-desc': 'Desain banner untuk peringatan Hari Santri dengan konsep modern dan religius.',
        'project-ui-title': 'UI/UX Design',
        'project-ui-desc': 'Perancangan antarmuka pengguna yang intuitif dan modern menggunakan Figma.',
        'project-poster-title': 'Poster',
        'project-poster-desc': 'Desain poster promosi dengan visual yang menarik dan informatif.',
        'project-web-title': 'Website',
        'project-web-desc': 'Pengembangan aplikasi web fullstack dengan fitur lengkap dan responsif.',
        'project-poster2-title': 'Poster Kreatif',
        'project-poster2-desc': 'Desain poster kreatif dengan konsep yang unik dan eye-catching.',
        
        // Project technologies
        'tech-figma': 'Figma',
        'tech-photoshop': 'Adobe Photoshop',
        'tech-illustrator': 'Adobe Illustrator',
        'tech-premiere': 'Adobe Premiere Pro',
        'tech-aftereffects': 'Adobe After Effects',
        'tech-php': 'PHP',
        'tech-codeigniter': 'CodeIgniter',
        'tech-laravel': 'Laravel',
        'tech-javascript': 'JavaScript',
        'tech-jquery': 'jQuery',
        'tech-mysql': 'MySQL',
        'tech-html': 'HTML5',
        'tech-css': 'CSS3',
        'tech-bootstrap': 'Bootstrap',
        'tech-tailwind': 'Tailwind CSS',
        'tech-corel': 'CorelDRAW',
        'tech-canva': 'Canva',
        'tech-blender': 'Blender',
        'tech-sketch': 'Sketch',
        
        // Gallery notifications and states
        'gallery-loading': 'Memuat proyek...',
        'gallery-filter-loading': 'Memfilter proyek...',
        'gallery-error': 'Terjadi kesalahan saat memuat galeri.',
        'gallery-empty': 'Belum ada proyek untuk ditampilkan.',
        'image-load-error': 'Gambar tidak dapat dimuat',
        'image-alt-fallback': 'Gambar proyek tidak tersedia',
        
        // Loading states
        'loading': 'Memuat...',
        'please-wait': 'Mohon tunggu...',
        'loading-projects': 'Memuat proyek...',
        'loading-complete': 'Selesai memuat',
        
        // Contact section
        'contact-title': 'Hubungi Saya',
        'contact-subtitle': 'Mari Berkolaborasi!',
        'contact-description': 'Saya selalu tertarik dengan proyek-proyek menarik. Mari diskusikan bagaimana kita bisa bekerja sama.',
        'contact-cta': 'Siap untuk memulai proyek bersama?',
        'form-name': 'Nama Anda',
        'form-email': 'Email Anda',
        'form-subject': 'Subjek',
        'form-message': 'Pesan Anda',
        'form-required': 'Wajib diisi',
        'btn-send': 'Kirim Pesan',
        'btn-sending': 'Mengirim...',
        'btn-sent': 'Terkirim',
        
        // Footer
        'footer-text': 'Â© 2025 Irsyada Rafi Ananta. All rights reserved.',
        'footer-made-with': 'Dibuat dengan',
        'footer-love': 'cinta',
        'footer-location': 'Bandungan, Jawa Tengah',
        
        // Notifications and messages
        'form-success': 'Terima kasih! Pesan Anda telah dikirim. Saya akan segera menghubungi Anda.',
        'form-error-fields': 'Mohon isi semua field yang diperlukan.',
        'form-error-email': 'Mohon masukkan alamat email yang valid.',
        'form-error-message': 'Pesan terlalu pendek. Mohon berikan detail lebih lanjut.',
        'form-error-name': 'Nama minimal 2 karakter.',
        'form-error-subject': 'Subjek tidak boleh kosong.',
        'form-error-network': 'Terjadi kesalahan jaringan. Silakan coba lagi.',
        'notification-close': 'Tutup',
        'notification-retry': 'Coba Lagi',
        
        // Accessibility and navigation
        'close-notification': 'Tutup notifikasi',
        'open-menu': 'Buka menu',
        'close-menu': 'Tutup menu',
        'skip-to-content': 'Lewati ke konten utama',
        'back-to-top': 'Kembali ke atas',
        'next-project': 'Proyek selanjutnya',
        'previous-project': 'Proyek sebelumnya',
        'view-project': 'Lihat proyek',
        'filter-projects': 'Filter proyek berdasarkan kategori',
        'search-projects': 'Cari proyek',
        'project-category': 'Kategori proyek',
        'project-technologies': 'Teknologi yang digunakan',
        
        // Error messages
        'error-404': 'Halaman tidak ditemukan',
        'error-500': 'Terjadi kesalahan server',
        'error-network': 'Tidak ada koneksi internet',
        'error-generic': 'Terjadi kesalahan yang tidak terduga',
        'try-again': 'Coba Lagi',
        'go-home': 'Kembali ke Beranda',
        
        // Social media
        'social-github': 'GitHub',
        'social-linkedin': 'LinkedIn',
        'social-instagram': 'Instagram',
        'social-twitter': 'Twitter',
        'social-dribbble': 'Dribbble',
        'social-behance': 'Behance',
        
        // Time and date
        'date-updated': 'Diperbarui',
        'date-created': 'Dibuat',
        'duration-years': 'tahun',
        'duration-months': 'bulan',
        'duration-weeks': 'minggu',
        'duration-days': 'hari',
        'duration-hours': 'jam',
        'duration-minutes': 'menit',
        'duration-seconds': 'detik',
        'duration-ago': 'yang lalu',
    },
    
    en: {
        // Meta and page info
        'page-title': 'Portfolio - Irsyada Rafi Ananta',
        'meta-description': 'Portfolio of Irsyada Rafi Ananta - Graphic Design & UI/UX Designer with experience in web development and digital design',
        
        // Navigation
        'nav-home': 'Home',
        'nav-about': 'About',
        'nav-skills': 'Skills',
        'nav-projects': 'Projects',
        'nav-contact': 'Contact',
        
        // Hero section
        'hero-greeting': 'Hello, I\'m',
        'hero-role': 'Graphic Design & UI/UX Designer',
        'hero-description': 'I create amazing digital experiences with attractive and functional designs.',
        'btn-view-projects': 'View Projects',
        'btn-contact-me': 'Contact Me',
        
        // About section
        'about-title': 'About Me',
        'about-description': 'Fresh graduate of D3 Informatics Engineering with internship experience as a Fullstack Developer. Skilled in end-to-end web application development using PHP, CodeIgniter, and JavaScript. Have a high passion for designing intuitive and functional user interfaces (UI/UX) using Figma to provide the best user experience.',
        
        // Skills section
        'skills-title': 'My Skills',
        
        // Projects section - Gallery
        'projects-title': 'My Projects',
        
        // Project filters
        'filter-all': 'All',
        'filter-ui-ux': 'UI/UX',
        'filter-web': 'Website',
        'filter-design': 'Design',
        'filter-mobile': 'Mobile',
        'filter-graphic': 'Graphics',
        
        // Project search
        'search-placeholder': 'Search projects...',
        'search-no-results': 'No projects found.',
        'search-results-count': 'projects found',
        'search-try-different': 'Try different keywords or select another category.',
        
        // Project actions
        'btn-view-details': 'View Details',
        'btn-view-demo': 'View Demo',
        'btn-view-code': 'View Code',
        'btn-download': 'Download',
        'btn-live-preview': 'Live Preview',
        
        // Project titles and descriptions
        'project-craft-title': 'UI/UX Traditional Crafts',
        'project-craft-desc': 'Application interface design for promoting traditional crafts with modern concepts that preserve cultural values.',
        'project-food-title': 'UI/UX Food Ordering',
        'project-food-desc': 'Food ordering application with user-friendly interface and easy checkout process.',
        'project-car-title': 'UI/UX Car Modification Website',
        'project-car-desc': 'Website for car modification services with showcase gallery and online booking system.',
        'project-banner-title': 'Banner Design',
        'project-banner-desc': 'Banner design for Santri Day commemoration with modern and religious concepts.',
        'project-ui-title': 'UI/UX Design',
        'project-ui-desc': 'Intuitive and modern user interface design using Figma.',
        'project-poster-title': 'Poster',
        'project-poster-desc': 'Promotional poster design with attractive and informative visuals.',
        'project-web-title': 'Website',
        'project-web-desc': 'Fullstack web application development with complete and responsive features.',
        'project-poster2-title': 'Creative Poster',
        'project-poster2-desc': 'Creative poster design with unique and eye-catching concepts.',
        
        // Project technologies
        'tech-figma': 'Figma',
        'tech-photoshop': 'Adobe Photoshop',
        'tech-illustrator': 'Adobe Illustrator',
        'tech-premiere': 'Adobe Premiere Pro',
        'tech-aftereffects': 'Adobe After Effects',
        'tech-php': 'PHP',
        'tech-codeigniter': 'CodeIgniter',
        'tech-laravel': 'Laravel',
        'tech-javascript': 'JavaScript',
        'tech-jquery': 'jQuery',
        'tech-mysql': 'MySQL',
        'tech-html': 'HTML5',
        'tech-css': 'CSS3',
        'tech-bootstrap': 'Bootstrap',
        'tech-tailwind': 'Tailwind CSS',
        'tech-corel': 'CorelDRAW',
        'tech-canva': 'Canva',
        'tech-blender': 'Blender',
        'tech-sketch': 'Sketch',
        
        // Gallery notifications and states
        'gallery-loading': 'Loading projects...',
        'gallery-filter-loading': 'Filtering projects...',
        'gallery-error': 'An error occurred while loading the gallery.',
        'gallery-empty': 'No projects to display yet.',
        'image-load-error': 'Image could not be loaded',
        'image-alt-fallback': 'Project image not available',
        
        // Loading states
        'loading': 'Loading...',
        'please-wait': 'Please wait...',
        'loading-projects': 'Loading projects...',
        'loading-complete': 'Loading complete',
        
        // Contact section
        'contact-title': 'Contact Me',
        'contact-subtitle': 'Let\'s Collaborate!',
        'contact-description': 'I\'m always interested in exciting projects. Let\'s discuss how we can work together.',
        'contact-cta': 'Ready to start a project together?',
        'form-name': 'Your Name',
        'form-email': 'Your Email',
        'form-subject': 'Subject',
        'form-message': 'Your Message',
        'form-required': 'Required',
        'btn-send': 'Send Message',
        'btn-sending': 'Sending...',
        'btn-sent': 'Sent',
        
        // Footer
        'footer-text': 'Â© 2025 Irsyada Rafi Ananta. All rights reserved.',
        'footer-made-with': 'Made with',
        'footer-love': 'love',
        'footer-location': 'Bandungan, Central Java',
        
        // Notifications and messages
        'form-success': 'Thank you! Your message has been sent. I will contact you soon.',
        'form-error-fields': 'Please fill in all required fields.',
        'form-error-email': 'Please enter a valid email address.',
        'form-error-message': 'Message is too short. Please provide more details.',
        'form-error-name': 'Name must be at least 2 characters.',
        'form-error-subject': 'Subject cannot be empty.',
        'form-error-network': 'Network error occurred. Please try again.',
        'notification-close': 'Close',
        'notification-retry': 'Retry',
        
        // Accessibility and navigation
        'close-notification': 'Close notification',
        'open-menu': 'Open menu',
        'close-menu': 'Close menu',
        'skip-to-content': 'Skip to main content',
        'back-to-top': 'Back to top',
        'next-project': 'Next project',
        'previous-project': 'Previous project',
        'view-project': 'View project',
        'filter-projects': 'Filter projects by category',
        'search-projects': 'Search projects',
        'project-category': 'Project category',
        'project-technologies': 'Technologies used',
        
        // Error messages
        'error-404': 'Page not found',
        'error-500': 'Server error occurred',
        'error-network': 'No internet connection',
        'error-generic': 'An unexpected error occurred',
        'try-again': 'Try Again',
        'go-home': 'Go Home',
        
        // Social media
        'social-github': 'GitHub',
        'social-linkedin': 'LinkedIn',
        'social-instagram': 'Instagram',
        'social-twitter': 'Twitter',
        'social-dribbble': 'Dribbble',
        'social-behance': 'Behance',
        
        // Time and date
        'date-updated': 'Updated',
        'date-created': 'Created',
        'duration-years': 'years',
        'duration-months': 'months',
        'duration-weeks': 'weeks',
        'duration-days': 'days',
        'duration-hours': 'hours',
        'duration-minutes': 'minutes',
        'duration-seconds': 'seconds',
        'duration-ago': 'ago',
    }
};

// Enhanced Language Manager with better performance and features
class LanguageManager {
    constructor() {
        this.currentLanguage = this.detectLanguage();
        this.observers = [];
        this.isTransitioning = false;
        this.init();
    }
    
    detectLanguage() {
        // Check localStorage first
        const savedLanguage = localStorage.getItem('preferred-language');
        if (savedLanguage && translations[savedLanguage]) {
            return savedLanguage;
        }
        
        // Check browser language
        const browserLang = navigator.language.slice(0, 2);
        if (translations[browserLang]) {
            return browserLang;
        }
        
        // Default to Indonesian
        return 'id';
    }
    
    init() {
        this.updateLanguage(this.currentLanguage);
        this.setupLanguageSwitcher();
        this.setupMutationObserver();
    }
    
    setupLanguageSwitcher() {
        const langToggle = document.getElementById('language-toggle');
        if (langToggle) {
            langToggle.addEventListener('click', () => {
                this.switchLanguage();
            });
        }
    }
    
    setupMutationObserver() {
        // Watch for dynamically added elements that need translation
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                mutation.addedNodes.forEach((node) => {
                    if (node.nodeType === Node.ELEMENT_NODE) {
                        this.translateElement(node);
                        const translatableElements = node.querySelectorAll('[data-translate]');
                        translatableElements.forEach(el => this.translateElement(el));
                    }
                });
            });
        });
        
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    }
    
    switchLanguage() {
        if (this.isTransitioning) return;
        
        const langBtn = document.getElementById('language-toggle');
        
        this.isTransitioning = true;
        langBtn.classList.add('loading');
        
        const newLanguage = this.currentLanguage === 'id' ? 'en' : 'id';
        
        document.body.classList.add('language-transition');
        
        setTimeout(() => {
            this.updateLanguage(newLanguage);
            this.updateDynamicContent();
            
            langBtn.classList.remove('loading');
            document.body.classList.remove('language-transition');
            document.body.classList.add('language-transition', 'complete');
            
            // Dispatch custom event
            window.dispatchEvent(new CustomEvent('languageChanged', {
                detail: { 
                    language: newLanguage,
                    previousLanguage: this.currentLanguage === 'id' ? 'en' : 'id'
                }
            }));
            
            setTimeout(() => {
                document.body.classList.remove('language-transition', 'complete');
                this.isTransitioning = false;
            }, 300);
        }, 250);
    }
    
    updateLanguage(language) {
        if (!translations[language]) return;
        
        this.currentLanguage = language;
        localStorage.setItem('preferred-language', language);
        
        // Update HTML lang attribute
        document.documentElement.lang = language;
        
        // Update all translatable elements
        const elements = document.querySelectorAll('[data-translate]');
        elements.forEach(element => this.translateElement(element));
        
        // Update language switcher
        this.updateLanguageSwitcher();
        
        // Update document title and meta
        this.updateDocumentMeta();
    }
    
    translateElement(element) {
        const key = element.getAttribute('data-translate');
        if (!key) return;
        
        const translation = translations[this.currentLanguage][key];
        if (!translation) return;
        
        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
            element.placeholder = translation;
        } else if (element.hasAttribute('title')) {
            element.title = translation;
        } else if (element.hasAttribute('aria-label')) {
            element.setAttribute('aria-label', translation);
        } else {
            // Preserve HTML structure for mixed content
            if (element.innerHTML.includes('<span class="highlight">')) {
                const highlightContent = element.querySelector('.highlight').textContent;
                element.innerHTML = translation + ' <span class="highlight">' + highlightContent + '</span>';
            } else {
                element.textContent = translation;
            }
        }
    }
    
    updateDocumentMeta() {
        // Update document title
        document.title = translations[this.currentLanguage]['page-title'];
        
        // Update meta description
        const metaDescription = document.querySelector('meta[name="description"]');
        if (metaDescription) {
            metaDescription.content = translations[this.currentLanguage]['meta-description'];
        }
    }
    
    updateDynamicContent() {
        // Update filter buttons
        const filterButtons = document.querySelectorAll('.filter-btn[data-filter]');
        filterButtons.forEach(btn => {
            const filterValue = btn.getAttribute('data-filter');
            const translationKey = `filter-${filterValue}`;
            const translation = this.translate(translationKey);
            if (translation !== translationKey) {
                btn.textContent = translation;
            }
        });
        
        // Update search placeholder
        const searchInput = document.getElementById('project-search');
        if (searchInput) {
            searchInput.placeholder = this.translate('search-placeholder');
        }
        
        // Update any dynamic notifications
        this.updateExistingNotifications();
    }
    
    updateExistingNotifications() {
        const notifications = document.querySelectorAll('.notification');
        notifications.forEach(notification => {
            const closeBtn = notification.querySelector('.notification-close');
            if (closeBtn) {
                closeBtn.setAttribute('aria-label', this.translate('close-notification'));
                closeBtn.title = this.translate('close-notification');
            }
        });
    }
    
    updateLanguageSwitcher() {
        const flagIcon = document.querySelector('.flag-icon');
        const langText = document.querySelector('.lang-text');
        
        if (flagIcon && langText) {
            if (this.currentLanguage === 'id') {
                flagIcon.textContent = 'ð®ð©';
                langText.textContent = 'ID';
            } else {
                flagIcon.textContent = 'ðºð¸';
                langText.textContent = 'EN';
            }
        }
    }
    
    getCurrentLanguage() {
        return this.currentLanguage;
    }
    
    translate(key) {
        return translations[this.currentLanguage][key] || key;
    }
    
    translateDynamic(key, params = {}) {
        let translation = this.translate(key);
        
        Object.keys(params).forEach(param => {
            translation = translation.replace(`{${param}}`, params[param]);
        });
        
        return translation;
    }
    
    getCategory(category) {
        const categoryKeys = Object.keys(translations[this.currentLanguage])
            .filter(key => key.startsWith(category + '-'));
        
        const result = {};
        categoryKeys.forEach(key => {
            result[key] = translations[this.currentLanguage][key];
        });
        
        return result;
    }
    
    // Method to add translation observer
    addObserver(callback) {
        this.observers.push(callback);
    }
    
    // Method to remove translation observer
    removeObserver(callback) {
        const index = this.observers.indexOf(callback);
        if (index > -1) {
            this.observers.splice(index, 1);
        }
    }
    
    // Notify all observers of language change
    notifyObservers(language) {
        this.observers.forEach(callback => {
            if (typeof callback === 'function') {
                callback(language);
            }
        });
    }
}

// Initialize language manager when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    window.languageManager = new LanguageManager();
    
    // Add global event listeners for language changes
    window.addEventListener('languageChanged', (e) => {
        console.log('ð Language changed to:', e.detail.language);
    });
});

// Global utility function for translations
window.t = function(key, params = {}) {
    if (window.languageManager) {
        return window.languageManager.translateDynamic(key, params);
    }
    return key;
};

// Global utility to get current language
window.getCurrentLanguage = function() {
    return window.languageManager ? window.languageManager.getCurrentLanguage() : 'id';
};

// Export for use in other scripts
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { translations, LanguageManager };
}

console.log('ð Translation system loaded successfully!');
